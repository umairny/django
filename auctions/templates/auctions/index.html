{% extends "auctions/layout.html" %}
{% load humanize %} <!-- https://docs.djangoproject.com/en/3.0/ref/contrib/humanize -->
{% block content %}

<h2>{{ title }}</h2>
    <div class="container-fluid card-columns">
    {% for list in listing %}
        <div class="card" style="width: 20rem;">

        {% if list.content_type %}
            <img style="width:100%; border:3px solid black;" src="{% url 'auctions:list_picture' list.id %}">
        {% endif %}

        <div class="card-body">
             {% if list.closed %}
                    {% if user == user.is_authenticated %}
                        {% if list.current_winning_bidder %}
                            <div>Your item was SOLD to {{ list.current_winning_bidder }}</div>
                        {% else %}
                            <div> Bidding Closed.</div>
                        {% endif %}
                    {% else %}
                        {%  if list.current_winning_bidder == user %}
                            <div>Congratulations!!! You have won this auction</div>
                        {% elif list.current_winning_bidder is None %}
                            <div>Nobody showed any interest on this item and it has been closed.</div>
                        {% else %}
                            <div>An anonymous user has won this auction!</div>
                        {% endif %}
                    {% endif %}
                {% else %}
            <h3 class="card-title"> {{list.title}} </h3>
            <p class="card-text"> <h5>Details:</h5>{{list.details}} </p>
            <h6> Price: {{list.price}} </h6>
            <div style="color:Darkblue;">
            {% if list.no_of_bids > 0 %}
                <h6>Cur bid: {{ list.cur_price }} </h6>
                <P>Total no of bids {{ list.no_of_bids }}
            {% else %}
                <h6>No bid yet.</h6>
            {% endif %}
            </div>
            <h6>Category: {{list.category}} </h6>
            <p>Created date: {{list.created}} </p>
            
            {% if not user.is_authenticated %}
                <a name="Login" class="btn btn-primary" href="{% url 'login' %}?next={% url 'auctions:index' %}" role="button">Log In to start bid</a>
            {% else %}
                <a name="bid" class="btn btn-info" href="{% url 'auctions:listing' list.id %}" role="button">Bid now</a>
            {% endif %}
            {% if is_watch %}
                <a name="bid" class="btn btn-info" href="{% url 'auctions:watchlist' list.id %}" role="button">Remove</a>
            {% endif %}
            <p>Posted by {{ list.user }}</p>

        {% endif %} 
        </div>
    </div>
    {% endfor %}
</div>

{% endblock %}